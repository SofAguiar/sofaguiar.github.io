{
  "hash": "865d65ca67e3d00f18d2705122443462",
  "result": {
    "engine": "knitr",
    "markdown": "> Warning! The translation is still in progress, this is an automatic translation and it may not be correct\n\n# **How to visualize your database - creating beautiful graphs and tables**\n\nA well-done descriptive and exploratory analysis can often change the course of your research. This is the ideal time to think about your research objective, the scope of your work, and the main information you should pay attention to.\n\nIn this tutorial, we will use the database available through Kaggle [here](https://www.kaggle.com/datasets/asinow/diabetes-dataset). It describes more than 9,000 medical records of patients associated with the risk of diabetes.\n\n### First of all, prepare the environment\n\nIn programming, having the code organized is essential. Both so that you can return to the analyses you did and understand what was done, and so that you can collaborate with other researchers.\n\nWe will start by configuring our environment, loading the necessary packages and other settings.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Packages used\n# This structure loads and installs packages if they are not already installed\nif(!require(tidyverse)) install.packages(\"tidyverse\")\nif(!require(kableExtra)) install.packages(\"kableExtra\")\nif(!require(ggcorrplot)) install.packages(\"ggcorrplot\")\nif(!require(corrr)) install.packages(\"corrr\")\nif(!require(rstatix)) install.packages(\"rstatix\")\n\n# For possible variables with very small or very large values, this option\n# avoids scientific notation\noptions(scipen = 9999)\n```\n:::\n\n\n\n### Load your database\n\nFor databases on platforms like Kagle, there are n ways to load the database besides the traditional download and upload of the file. In my case, I downloaded the database and uploaded it to the website's GitHub since I'll be using the same dataset several times.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Browse through the folders and load the database in .csv\ndiabetes_dataset = read.csv(\"../../assets/datasets/diabetes_dataset.csv\")\n```\n:::\n\n\n\nBefore performing any analysis, we need to check the database. Ask yourself a few questions:\n\n- Were all the columns read correctly?\n\n- Were the decimal places set correctly?\n\n- What are the types of each column?\n\n- Are the characters set correctly?\n\nTo answer this, two simple commands and a little knowledge of what each variable means are enough.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Shows each column, the type and the first observations\nglimpse(diabetes_dataset)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 9,538\nColumns: 17\n$ Age                <int> 69, 32, 89, 78, 38, 41, 20, 39, 70, 19, 47, 55, 19,…\n$ Pregnancies        <int> 5, 1, 13, 13, 8, 10, 16, 4, 3, 1, 8, 0, 15, 12, 6, …\n$ BMI                <dbl> 28.39, 26.49, 25.34, 29.91, 24.56, 17.47, 15.76, 28…\n$ Glucose            <dbl> 130.1, 116.5, 101.0, 146.0, 103.2, 67.0, 61.6, 105.…\n$ BloodPressure      <dbl> 77, 72, 82, 104, 74, 71, 60, 94, 90, 62, 93, 87, 60…\n$ HbA1c              <dbl> 5.4, 4.5, 4.9, 5.7, 4.7, 4.2, 4.0, 4.5, 4.0, 4.0, 4…\n$ LDL                <dbl> 130.4, 87.4, 112.5, 50.7, 102.5, 105.3, 62.4, 91.0,…\n$ HDL                <dbl> 44.0, 54.2, 56.8, 39.1, 29.1, 58.8, 43.4, 50.1, 51.…\n$ Triglycerides      <dbl> 50.0, 129.9, 177.6, 117.0, 145.9, 140.7, 64.6, 195.…\n$ WaistCircumference <dbl> 90.5, 113.3, 84.7, 108.9, 84.1, 81.8, 66.5, 123.2, …\n$ HipCircumference   <dbl> 107.9, 81.4, 107.2, 110.0, 92.8, 93.2, 102.7, 121.4…\n$ WHR                <dbl> 0.84, 1.39, 0.79, 0.99, 0.91, 0.88, 0.65, 1.01, 0.7…\n$ FamilyHistory      <int> 0, 0, 0, 0, 0, 1, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, …\n$ DietType           <int> 0, 0, 0, 0, 1, 0, 1, 0, 1, 0, 0, 0, 1, 2, 1, 1, 1, …\n$ Hypertension       <int> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …\n$ MedicationUse      <int> 1, 0, 1, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 1, 0, 0, …\n$ Outcome            <int> 0, 0, 0, 1, 0, 1, 0, 1, 0, 1, 0, 0, 0, 0, 1, 0, 0, …\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Shows the first 6 rows of the database\nhead(diabetes_dataset)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  Age Pregnancies   BMI Glucose BloodPressure HbA1c   LDL  HDL Triglycerides\n1  69           5 28.39   130.1            77   5.4 130.4 44.0          50.0\n2  32           1 26.49   116.5            72   4.5  87.4 54.2         129.9\n3  89          13 25.34   101.0            82   4.9 112.5 56.8         177.6\n4  78          13 29.91   146.0           104   5.7  50.7 39.1         117.0\n5  38           8 24.56   103.2            74   4.7 102.5 29.1         145.9\n6  41          10 17.47    67.0            71   4.2 105.3 58.8         140.7\n  WaistCircumference HipCircumference  WHR FamilyHistory DietType Hypertension\n1               90.5            107.9 0.84             0        0            0\n2              113.3             81.4 1.39             0        0            0\n3               84.7            107.2 0.79             0        0            0\n4              108.9            110.0 0.99             0        0            0\n5               84.1             92.8 0.91             0        1            0\n6               81.8             93.2 0.88             1        0            0\n  MedicationUse Outcome\n1             1       0\n2             0       0\n3             1       0\n4             1       1\n5             0       0\n6             0       1\n```\n\n\n:::\n:::\n\n\n\n\nAll right! We can continue.\n\n### Reading the dictionary\n\nThe last step before a good descriptive and exploratory analysis is **reading the dictionary of variables**. This is essential to understand acronyms that may be in another language, check the unit of measurement of each variable and identify the type of each column.\n\n- Age: Age of the individual (18-90 years).\n- Pregnancies: Number of times the patient has been pregnant.\n- BMI (Body Mass Index - BMI): Measurement of body fat based on height and weight (kg/m²).\n- Glucose: Blood glucose concentration (mg/dL), a key indicator of diabetes.\n- Blood Pressure: Systolic blood pressure (mmHg), high levels may indicate hypertension.\n- HbA1c: Glycated hemoglobin level (%), representing the average blood sugar level over several months.\n- LDL (Low-Density Lipoprotein): Level of \"bad\" cholesterol (mg/dL).\n- HDL (High-Density Lipoprotein): Level of \"good\" cholesterol (mg/dL).\n- Triglycerides: Levels of fat in the blood (mg/dL), high values ​​increase the risk of diabetes.\n- Waist Circumference: Waist measurement (cm), indicator of central obesity. - Hip Circumference (HipCircumference): Hip measurement (cm), used to calculate the waist-to-hip ratio.\n- Waist-to-Hip Ratio (WHR): Waist circumference divided by hip circumference.\n- Family History (FamilyHistory): Indicates whether the individual has a family history of diabetes (1 = Yes, 0 = No).\n- Diet Type (DietType): Eating habits (0 = Unbalanced, 1 = Balanced, 2 = Vegan/Vegetarian).\n- Hypertension (Hypertension): Presence of high blood pressure (1 = Yes, 0 = No).\n- Medication Use (MedicationUse): Indicates whether the individual uses medication (1 = Yes, 0 = No).\n- Outcome: Diagnosis of diabetes (1 = Diabetes, 0 = No Diabetes).\n\n### Univariate Analysis\n\nWe finally get to the stage of creating graphs and tables. An important piece of knowledge is knowing how to distinguish continuous variables (numbers and measurements) from categorical variables (classifications of some kind, such as race and sex).\n\nFor continuous variables, summary measures in a single table are an excellent way to add information to a report. For you, the researcher, to understand your database, creating histograms is a great way to visualize what is happening with each column, and to notice outliers and asymmetries.\n\n### Univariate Analysis\n\nWe finally get to the stage of creating graphs and tables. An important piece of knowledge is knowing how to distinguish continuous variables (numbers and measurements) from categorical variables (classifications of some kind, such as race and sex).\n\nFor continuous variables, summary measurements in a single table are an excellent way to add information to a report. For you, the researcher, to understand your database, creating histograms is a great way to visualize what is happening with each column, and to notice outliers and asymmetry, even if you don't include them in the report.\n\nSo, to run the histogram, I recommend using the ggplot2 package, which provides a beautiful graph with relatively little effort.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndiabetes_dataset %>% # Opens the database\nselect(WaistCircumference) %>% # Selects the variable of interest\nggplot(aes(x = WaistCircumference)) + # Calls the function to create graphs by placing our var on the x axis\ngeom_histogram(fill = \"#F2C354\", color = \"white\") + # Creates the histogram with the desired colors\nlabs(title = \"Histogram for Waist Circumference in cm\", # Adds title\nx = \"Waist Circumference (cm)\", # And replaces the default text on the axes\ny = \"Frequency\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](data-viz_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\n\nAnd now for our table we will need a little more code.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# We define the labels in Portuguese for each categorical variable\nrotulos_categoricas <- c( FamilyHistory = \"Family History\", # Indicates whether the individual has a family history of diabetes (1 = Yes, 0 = No)\nDietType = \"Diet Type\", # Eating habits (0 = Unbalanced, 1 = Balanced, 2 = Vegan/Vegetarian)\nHypertension = \"Hypertension\", # Presence of high blood pressure (1 = Yes, 0 = No)\nMedicationUse = \"Use of Medications\", # Indicates whether the individual uses medication (1 = Yes, 0 = No)\nOutcome = \"Result\" # Diagnosis of diabetes (1 = Diabetes, 0 = No Diabetes)\n)\n# We select only the categorical variables based on the defined labels\nvariaveis_categoricas <- names(rotulos_categoricas)\n\n# Calculate the frequency and proportion for each category of categorical variables\nresumo_categoricas <- diabetes_dataset %>% # Access the dataset\nselect(all_of(variaveis_categoricas)) %>% # Select the categorical columns\npivot_longer(cols = everything(), names_to = \"Variável\", values_to = \"Categoria\") %>% # Convert the wide format to long\ngroup_by(Variável,Categoria) %>% # Groups by unique values ​​of categorical variables\nsummarise(Frequency = n(), .groups = \"drop\") %>% # Counts how many times each category appears\nmutate(Proportion = Frequency / sum(Frequency) * 100) %>% # Calculates the relative percentage of each category\nmutate(Variável = recode(Variável, !!!rotulos_categoricas)) # Replaces the variable names with the labels in Portuguese\n\n# Let's create the table formatted\nresumo_categoricas %>% # Calls the created summary\nkable(\"html\",\ncaption = \"Distribution of categorical variables\", # Uses kable from the kableExtra library\nalign = \"c\", # Aligns the text to the center\ncol.names = c(\"Variable\", \"Category\", \"Frequency\", \"Proportion (%)\")) %>% # Defines the column names\nkable_styling(full_width = FALSE,\nbootstrap_options = c(\"striped\", \"hover\")) %>% # Applies style settings\nfootnote(general = \"Source: Prepared by the author.\", # Adds the table font\ngeneral_title = \"\") %>%\nadd_header_above(c(\" \" = 1, \"Descriptive Statistics\" = 3)) # Adds a header for the statistics columns\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-hover\" style=\"width: auto !important; margin-left: auto; margin-right: auto;border-bottom: 0;\">\n<caption>Distribution of categorical variables</caption>\n <thead>\n<tr>\n<th style=\"empty-cells: hide;border-bottom:hidden;\" colspan=\"1\"></th>\n<th style=\"border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; \" colspan=\"3\"><div style=\"border-bottom: 1px solid #ddd; padding-bottom: 5px; \">Descriptive Statistics</div></th>\n</tr>\n  <tr>\n   <th style=\"text-align:center;\"> Variable </th>\n   <th style=\"text-align:center;\"> Category </th>\n   <th style=\"text-align:center;\"> Frequency </th>\n   <th style=\"text-align:center;\"> Proportion (%) </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:center;\"> Diet Type </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 5794 </td>\n   <td style=\"text-align:center;\"> 12.1492975 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> Diet Type </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 2851 </td>\n   <td style=\"text-align:center;\"> 5.9781925 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> Diet Type </td>\n   <td style=\"text-align:center;\"> 2 </td>\n   <td style=\"text-align:center;\"> 893 </td>\n   <td style=\"text-align:center;\"> 1.8725100 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> Family History </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 6653 </td>\n   <td style=\"text-align:center;\"> 13.9505137 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> Family History </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 2885 </td>\n   <td style=\"text-align:center;\"> 6.0494863 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> Hypertension </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 9528 </td>\n   <td style=\"text-align:center;\"> 19.9790312 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> Hypertension </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 10 </td>\n   <td style=\"text-align:center;\"> 0.0209688 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> Use of Medications </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 5675 </td>\n   <td style=\"text-align:center;\"> 11.8997693 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> Use of Medications </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 3863 </td>\n   <td style=\"text-align:center;\"> 8.1002307 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> Result </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 6256 </td>\n   <td style=\"text-align:center;\"> 13.1180541 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> Result </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 3282 </td>\n   <td style=\"text-align:center;\"> 6.8819459 </td>\n  </tr>\n</tbody>\n<tfoot><tr><td style=\"padding: 0; \" colspan=\"100%\">\n<sup></sup> Source: Prepared by the author.</td></tr></tfoot>\n</table>\n\n`````\n:::\n:::\n\n\n\nFor other formatting, just search a little in the package documentation kableExtra and understand what needs to be changed.\n\nFor categorical variables, the process is very similar. We will create a bar chart (never a pie chart!!) and a table with the summary measures.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndiabetes_dataset %>% # Opens the database\nselect(FamilyHistory) %>% # Selects the variable of interest\nggplot(aes(x = as.factor(FamilyHistory))) + # Calls the function to create graphs by placing our var on the x axis as a factor (i.e. categorical var)\ngeom_bar(fill = \"#C97064\", color = \"white\") + # Creates the bar graph with the desired colors\nlabs(title = \"Distribution for Family History of Diabetes\", # Adds title\nx = \"Do you have a family history? (0 = no, 1 = yes)\", # And replaces the default text on the axes\ny = \"Frequency\")\n```\n\n::: {.cell-output-display}\n![](data-viz_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\n\nIt may also be interesting to create a graph for the group proportions on the y axis, in order to facilitate visualization. Just change a few lines of code as seen below.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndiabetes_dataset %>% # Open the database\ncount(FamilyHistory) %>% # Count the occurrences of each category\nmutate(Proportion = n / sum(n)) %>% # Calculate the proportion\nggplot(aes(x = as.factor(FamilyHistory), y = Proportion)) + # Set the axes\ngeom_col(fill = \"#68A357\", color = \"white\") + # Create the bar chart\nlabs(title = \"Distribution of Family History of Diabetes\", # Add title\nx = \"Do you have a family history? (0 = no, 1 = yes)\", # And replace the default text on the axes\ny = \"Proportion\")\n```\n\n::: {.cell-output-display}\n![](data-viz_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\n\nFinally, now let's make the tables for the categorical variables. \n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# We define the labels in Portuguese for each categorical variable\nrotulos_categoricas <- c(\nFamilyHistory = \"Family History\", # Indicates whether the individual has a family history of diabetes (1 = Yes, 0 = No)\nDietType = \"Diet Type\", # Eating habits (0 = Unbalanced, 1 = Balanced, 2 = Vegan/Vegetarian)\nHypertension = \"Hypertension\", # Presence of high blood pressure (1 = Yes, 0 = No)\nMedicationUse = \"Use of Medications\", # Indicates whether the individual uses medication (1 = Yes, 0 = No)\nOutcome = \"Resultado\" # Diagnosis of diabetes (1 = Diabetes, 0 = No Diabetes)\n)\n# We select only the categorical variables based on the defined labels\nvariaveis_categoricas <- names(rotulos_categoricas)\n\n# Calculate the frequency and proportion for each category of categorical variables\nresumo_categoricas <- diabetes_dataset %>% # Access the dataset\nselect(all_of(variaveis_categoricas)) %>% # Select the categorical columns\npivot_longer(cols = everything(), names_to = \"Variável\", values_to = \"Categoria\") %>% # Convert the wide format to long\ngroup_by(Variável,Categoria) %>% # Groups by unique values of categorical variables\nsummarise(Frequency = n(), .groups = \"drop\") %>% # Counts how many times each category appears\nmutate(Proporção = Frequency / sum(Frequency) * 100) %>% # Calculates the relative percentage of each category\nmutate(Variável = recode(Variável, !!!rotulos_categoricas)) # Replaces the variable names with the labels in Portuguese\n\n# We adjusted to remove the repetition of the name of the variable\nresumo_categoricas <- resumo_categoricas %>%\ngroup_by(Variável) %>%\nmutate(Variável = ifelse(row_number() == 1, Variável, \"\")) %>% # Keeps the name only in the first line of each group\nungroup()\n\n# We create the formatted table\nresumo_categoricas %>% # Calls the created summary\nkable(\"html\",\ncaption = \"Distribution of categorical variables\", # Uses kable from the kableExtra library\nalign = \"c\", # Aligns the text to the center\ncol.names = c(\"Variable\", \"Category\", \"Frequency\", \"Proportion (%)\")) %>% # Defines the column names\nkable_styling(full_width = FALSE,\nbootstrap_options = c(\"striped\", \"hover\")) %>% # Applies style settings\nfootnote(general = \"Source: Prepared by the author.\", # Add the table source\ngeneral_title = \"\") %>%\nadd_header_above(c(\" \" = 1, \"Descriptive Statistics\" = 3)) # Add a header for the statistics columns\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-hover\" style=\"width: auto !important; margin-left: auto; margin-right: auto;border-bottom: 0;\">\n<caption>Distribution of categorical variables</caption>\n <thead>\n<tr>\n<th style=\"empty-cells: hide;border-bottom:hidden;\" colspan=\"1\"></th>\n<th style=\"border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; \" colspan=\"3\"><div style=\"border-bottom: 1px solid #ddd; padding-bottom: 5px; \">Descriptive Statistics</div></th>\n</tr>\n  <tr>\n   <th style=\"text-align:center;\"> Variable </th>\n   <th style=\"text-align:center;\"> Category </th>\n   <th style=\"text-align:center;\"> Frequency </th>\n   <th style=\"text-align:center;\"> Proportion (%) </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:center;\"> Diet Type </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 5794 </td>\n   <td style=\"text-align:center;\"> 12.1492975 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\">  </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 2851 </td>\n   <td style=\"text-align:center;\"> 5.9781925 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\">  </td>\n   <td style=\"text-align:center;\"> 2 </td>\n   <td style=\"text-align:center;\"> 893 </td>\n   <td style=\"text-align:center;\"> 1.8725100 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> Family History </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 6653 </td>\n   <td style=\"text-align:center;\"> 13.9505137 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\">  </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 2885 </td>\n   <td style=\"text-align:center;\"> 6.0494863 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> Hypertension </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 9528 </td>\n   <td style=\"text-align:center;\"> 19.9790312 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\">  </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 10 </td>\n   <td style=\"text-align:center;\"> 0.0209688 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> Use of Medications </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 5675 </td>\n   <td style=\"text-align:center;\"> 11.8997693 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\">  </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 3863 </td>\n   <td style=\"text-align:center;\"> 8.1002307 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> Resultado </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 6256 </td>\n   <td style=\"text-align:center;\"> 13.1180541 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\">  </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 3282 </td>\n   <td style=\"text-align:center;\"> 6.8819459 </td>\n  </tr>\n</tbody>\n<tfoot><tr><td style=\"padding: 0; \" colspan=\"100%\">\n<sup></sup> Source: Prepared by the author.</td></tr></tfoot>\n</table>\n\n`````\n:::\n:::\n\n\n\n### Bivariate analysis\n\nUnivariate analysis aims to understand the distribution of the variable itself. In bivariate (and multivariate) analysis, we want to understand the relationship between the variables. Note that I am not looking for causality or the predictive value of each variable; this will be a later step depending on your research objective.\n\nWe can start with a correlogram, which shows a map of the correlations of all continuous variables. It is very useful for identifying whether there is any collinearity between variables, which should be confirmed later through appropriate tests.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Select only continuous variables\ncontinuous_variables <- c(\"Age\", \"BMI\", \"Glucose\", \"BloodPressure\", \"HbA1c\",\n\"LDL\", \"HDL\", \"Triglycerides\", \"WaistCircumference\",\n\"HipCircumference\", \"WHR\")\n\n# Create the correlation matrix\ncorrelation_matrix <- diabetes_dataset %>%\nselect(all_of(continuous_variables)) %>% # Select only continuous variables\ncor(use = \"pairwise.complete.obs\") # Calculate the correlation excluding NA values\n\n# Create the correlogram\nggcorrplot(correlation_matrix,\nmethod = \"circle\", # Set the graph style (circles)\ntype = \"lower\", # Show only the lower half of the matrix\nlab = TRUE, # Show the correlation values\nlab_size = 3, # Size from the font of the labels\ncolors = c(\"#6D9EC1\", \"white\", \"#E46726\"), # Sets the color palette\ntitle = \"Correlogram of Continuous Variables\", # Adds a title\nggtheme = theme_minimal()) # Applies a minimalist theme\n```\n\n::: {.cell-output-display}\n![](data-viz_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n\n\nAnother very important form of correlation, especially for prediction studies, is the correlation of each variable with the outcome.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# We define continuous and categorical variables\ncontinuous_variables <- c(\"Age\", \"BMI\", \"Glucose\", \"BloodPressure\", \"HbA1c\",\n\"LDL\", \"HDL\", \"Triglycerides\", \"WaistCircumference\",\n\"HipCircumference\", \"WHR\")\n\ncategorical_variables <- c(\"FamilyHistory\", \"DietType\", \"Hypertension\",\n\"MedicationUse\")\n\n# --- Correlation for continuous variables with Outcome ---\ncontinuous_correlations <- diabetes_dataset %>%\nselect(all_of(continuous_variables), Outcome) %>%\ncor(use = \"pairwise.complete.obs\") %>%\nas.data.frame() %>%\nselect(Outcome) %>%\nrownames_to_column(var = \"Variable\") %>%\nrename(`Correlation` = Outcome) %>% # Rename for consistency\nmutate(Type = \"Continuous\")\n\n# --- Correlation for categorical variables with Outcome ---\ncalcular_cramer <- function(var) {\ntab <- table(diabetes_dataset[[var]], diabetes_dataset$Outcome)\ncramer <- rstatix::cramer_v(tab) %>% as.numeric() # Convert to number\nreturn(data.frame(Variable = var, `Correlation` = cramer, Type = \"Categorical\"))\n}\ncategorical_correlations <- bind_rows(lapply(categorical_variables, calcular_cramer))\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning in stats::chisq.test(x, y, correct = correct, ...): Aproximação do\nqui-quadrado pode estar incorreta\n```\n\n\n:::\n\n```{.r .cell-code}\n# --- We join all correlations ---\ntotal_correlations <- bind_rows(continuous_correlations, categorical_correlations) %>%\narrange(desc(abs(Correlation))) # Sort by the strength of the correlation\n\n# We define the labels in Portuguese for all variables\nlabels <- c(\nAge = \"Age (years)\",\nBMI = \"Body Mass Index (kg/m²)\",\nGlucose = \"Glucose (mg/dL)\",\nBloodPressure = \"Blood Pressure (mmHg)\",\nHbA1c = \"Glycated Hemoglobin (%)\",\nLDL = \"LDL Cholesterol (mg/dL)\",\nHDL = \"HDL Cholesterol (mg/dL)\",\nTriglycerides = \"Triglycerides (mg/dL)\",\nWaistCircumference = \"Waist Circumference (cm)\",\nHipCircumference = \"Hip Circumference (cm)\",\nWHR = \"Waist-to-Hip Ratio\", FamilyHistory = \"Family History\",\nDietType = \"Diet Type\",\nHypertension = \"Hypertension\",\nMedicationUse = \"Medication Use\"\n)\n\n# Remove the correlation of Outcome with itself\ntotal_correlations <- total_correlations %>%\nfilter(Variable != \"Outcome\") %>%\nmutate(Variable = recode(Variable, !!!labels)) # Apply labels\n\n# Display the formatted table\ntotal_correlations %>%\nmutate(Correlation = round(Correlation, 3)) %>% # Round values\nkable(\"html\",\ncaption = \"Correlation of All Variables with Outcome\",\nalign = \"c\",\ncol.names = c(\"Variable\", \"Correlation\", \"Type\")) %>% # Define column names\nkable_styling(full_width = FALSE,\nbootstrap_options = c(\"striped\", \"hover\")) %>% # Styling\nfootnote(general = \"Source: Prepared by the author.\",\ngeneral_title = \"\") %>%\nadd_header_above(c(\" \" = 1, \"Correlation with Outcome\" = 2)) # Top header\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-hover\" style=\"width: auto !important; margin-left: auto; margin-right: auto;border-bottom: 0;\">\n<caption>Correlation of All Variables with Outcome</caption>\n <thead>\n<tr>\n<th style=\"empty-cells: hide;border-bottom:hidden;\" colspan=\"1\"></th>\n<th style=\"border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; \" colspan=\"2\"><div style=\"border-bottom: 1px solid #ddd; padding-bottom: 5px; \">Correlation with Outcome</div></th>\n</tr>\n  <tr>\n   <th style=\"text-align:center;\"> Variable </th>\n   <th style=\"text-align:center;\"> Correlation </th>\n   <th style=\"text-align:center;\"> Type </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:center;\"> Family History </td>\n   <td style=\"text-align:center;\"> 0.909 </td>\n   <td style=\"text-align:center;\"> Categorical </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> Glucose (mg/dL) </td>\n   <td style=\"text-align:center;\"> 0.168 </td>\n   <td style=\"text-align:center;\"> Continuous </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> Glycated Hemoglobin (%) </td>\n   <td style=\"text-align:center;\"> 0.152 </td>\n   <td style=\"text-align:center;\"> Continuous </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> Body Mass Index (kg/m²) </td>\n   <td style=\"text-align:center;\"> 0.107 </td>\n   <td style=\"text-align:center;\"> Continuous </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> Blood Pressure (mmHg) </td>\n   <td style=\"text-align:center;\"> 0.096 </td>\n   <td style=\"text-align:center;\"> Continuous </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> Waist Circumference (cm) </td>\n   <td style=\"text-align:center;\"> 0.087 </td>\n   <td style=\"text-align:center;\"> Continuous </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> Hip Circumference (cm) </td>\n   <td style=\"text-align:center;\"> 0.083 </td>\n   <td style=\"text-align:center;\"> Continuous </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> Age (years) </td>\n   <td style=\"text-align:center;\"> 0.068 </td>\n   <td style=\"text-align:center;\"> Continuous </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> Medication Use </td>\n   <td style=\"text-align:center;\"> 0.064 </td>\n   <td style=\"text-align:center;\"> Categorical </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> Hypertension </td>\n   <td style=\"text-align:center;\"> 0.028 </td>\n   <td style=\"text-align:center;\"> Categorical </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> Waist-to-Hip Ratio </td>\n   <td style=\"text-align:center;\"> 0.022 </td>\n   <td style=\"text-align:center;\"> Continuous </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> LDL Cholesterol (mg/dL) </td>\n   <td style=\"text-align:center;\"> 0.019 </td>\n   <td style=\"text-align:center;\"> Continuous </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> Diet Type </td>\n   <td style=\"text-align:center;\"> 0.016 </td>\n   <td style=\"text-align:center;\"> Categorical </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> HDL Cholesterol (mg/dL) </td>\n   <td style=\"text-align:center;\"> -0.009 </td>\n   <td style=\"text-align:center;\"> Continuous </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> Triglycerides (mg/dL) </td>\n   <td style=\"text-align:center;\"> -0.008 </td>\n   <td style=\"text-align:center;\"> Continuous </td>\n  </tr>\n</tbody>\n<tfoot><tr><td style=\"padding: 0; \" colspan=\"100%\">\n<sup></sup> Source: Prepared by the author.</td></tr></tfoot>\n</table>\n\n`````\n:::\n:::\n\n\n\nFrom the given correlations we can create bivariate graphs with the variable of interest and a covariate.\n\nFor continuous covariates, we will use the boxplot as visualization and for categorical variables, stacked bar graphs.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndiabetes_dataset %>% # Open the database\nggplot(aes(x = as.factor(FamilyHistory), fill = as.factor(Outcome))) + # Call the graphing function, filling in the outcome\ngeom_bar(position = \"fill\", color = \"white\") + # Proportion within each group\nscale_fill_manual(values= c(\"#C97064\", \"#68A357\"), labels = c(\"No Diabetes\", \"Diabetes\")) + # Choose colors\nlabs(title = \"Family History Distribution by Outcome\", # Add title\nx = \"Family History (0 = No, 1 = Yes)\", # Add labels\ny = \"Proportion\",\nfill = \"Outcome\")\n```\n\n::: {.cell-output-display}\n![](data-viz_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndiabetes_dataset %>% # Open the database\nggplot(aes(x = as.factor(Outcome), y = Glucose, fill = as.factor(Outcome))) + # Call the function for filling graphs with the outcome\ngeom_boxplot(outlier.color = \"red\", outlier.shape = 16) + # Create the boxplot\nscale_fill_manual(values= c(\"#C97064\", \"#68A357\"), labels = c(\"No Diabetes\", \"Diabetes\")) + # Choose the colors\nlabs(title = \"Glucose Distribution by Outcome\", # Add title\nx = \"Outcome\", # Add captions\ny = \"Glucose (mg/dL)\",\nfill = \"Outcome\")\n```\n\n::: {.cell-output-display}\n![](data-viz_files/figure-html/unnamed-chunk-13-1.png){width=672}\n:::\n:::\n\n\n\n### Final considerations\n\nThe step-by-step suggested here is both for creating initial reports and for the researcher himself to better understand the database worked on. It is essential to do each step carefully and understand the need for pre-processing variables, such as adjusting the character to factor, and adapting the scripts as needed.\n\nI hope this helps!",
    "supporting": [
      "data-viz_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../../site_libs/kePrint-0.0.1/kePrint.js\"></script>\n<link href=\"../../site_libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}