{
  "hash": "ae6b16f1ec58627e553f6118a8656000",
  "result": {
    "engine": "knitr",
    "markdown": "# **Como vizualizar seu banco de dados - fazendo belos gráficos e tabelas**\n\nMuitas vezes uma análise descritiva e explotaória bem feita pode mudar os rumos da sua pesquisa. Esse é o momento ideal de pensar no seu objetivo de pesquisa, qual o escopo do seu trabalho e quais são as principais informações pelas quais se deve atentar.\n\nNesse tutorial usaremos o banco de dados disponível através do Kaggle [aqui](https://www.kaggle.com/datasets/asinow/diabetes-dataset). Ele descreve mais de 9 mil registros médicos de pacientes associados ao risco de diabetes.\n\n\n### Antes de tudo, prepare o ambiente\n\nEm programação, ter o código organizado é fundamental. Tanto para que você mesmo possa retornar às análises que fez e entender o que foi feito tanto para colaboração com outros pesquisadores.   \n\nComeçaremos com as configurações do nosso ambiente, carregando os pacotes necessários e outras configurações.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Pacotes utilizados\n# Essa estrutura carrega e instala os pacotes caso eles não estejam instalados ainda\nif(!require(tidyverse)) install.packages(\"tidyverse\")\nif(!require(kableExtra)) install.packages(\"kableExtra\")\nif(!require(ggcorrplot)) install.packages(\"ggcorrplot\")\nif(!require(corrr)) install.packages(\"corrr\")\nif(!require(rstatix)) install.packages(\"rstatix\")\n\n# Para possíveis variáveis com valores muito pequenos ou muito grandes, essa opção\n# evita a notaçào científica\noptions(scipen = 9999)\n```\n:::\n\n\n\n\n### Carregue seu banco\n\nPara bancos de dados em plataformas como o Kagle, há n formas de carregar o banco além do tradicional baixar e carregar o arquivo. No meu caso eu fiz download do banco e subi ele para o gitHub do site já que vou utilizar esse mesmo dataset várias vezes.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Navega pelas pastas e carrega o banco de dados em .csv\ndiabetes_dataset = read.csv(\"../../assets/datasets/diabetes_dataset.csv\")\n```\n:::\n\n\n\n\nAntes de fazer qualquer análise temos que verificar o banco. Faça algumas perguntas:\n\n- Todas as colunas foram lidas de forma correta?\n\n- As casas decimais foram configuradas corretamente?\n\n- Quais são os tipos de cada coluna?\n\n- Os caracteres estão bem configurados?\n\nPara responder isso dois comando simples e um pouco de conhecimento do que cada variável significa basta.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Mostra cada coluna, o tipo e as primeiras observações\nglimpse(diabetes_dataset)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 9,538\nColumns: 17\n$ Age                <int> 69, 32, 89, 78, 38, 41, 20, 39, 70, 19, 47, 55, 19,…\n$ Pregnancies        <int> 5, 1, 13, 13, 8, 10, 16, 4, 3, 1, 8, 0, 15, 12, 6, …\n$ BMI                <dbl> 28.39, 26.49, 25.34, 29.91, 24.56, 17.47, 15.76, 28…\n$ Glucose            <dbl> 130.1, 116.5, 101.0, 146.0, 103.2, 67.0, 61.6, 105.…\n$ BloodPressure      <dbl> 77, 72, 82, 104, 74, 71, 60, 94, 90, 62, 93, 87, 60…\n$ HbA1c              <dbl> 5.4, 4.5, 4.9, 5.7, 4.7, 4.2, 4.0, 4.5, 4.0, 4.0, 4…\n$ LDL                <dbl> 130.4, 87.4, 112.5, 50.7, 102.5, 105.3, 62.4, 91.0,…\n$ HDL                <dbl> 44.0, 54.2, 56.8, 39.1, 29.1, 58.8, 43.4, 50.1, 51.…\n$ Triglycerides      <dbl> 50.0, 129.9, 177.6, 117.0, 145.9, 140.7, 64.6, 195.…\n$ WaistCircumference <dbl> 90.5, 113.3, 84.7, 108.9, 84.1, 81.8, 66.5, 123.2, …\n$ HipCircumference   <dbl> 107.9, 81.4, 107.2, 110.0, 92.8, 93.2, 102.7, 121.4…\n$ WHR                <dbl> 0.84, 1.39, 0.79, 0.99, 0.91, 0.88, 0.65, 1.01, 0.7…\n$ FamilyHistory      <int> 0, 0, 0, 0, 0, 1, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, …\n$ DietType           <int> 0, 0, 0, 0, 1, 0, 1, 0, 1, 0, 0, 0, 1, 2, 1, 1, 1, …\n$ Hypertension       <int> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …\n$ MedicationUse      <int> 1, 0, 1, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 1, 0, 0, …\n$ Outcome            <int> 0, 0, 0, 1, 0, 1, 0, 1, 0, 1, 0, 0, 0, 0, 1, 0, 0, …\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Mostra as 6 primeiras linhas do banco de dados\nhead(diabetes_dataset)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  Age Pregnancies   BMI Glucose BloodPressure HbA1c   LDL  HDL Triglycerides\n1  69           5 28.39   130.1            77   5.4 130.4 44.0          50.0\n2  32           1 26.49   116.5            72   4.5  87.4 54.2         129.9\n3  89          13 25.34   101.0            82   4.9 112.5 56.8         177.6\n4  78          13 29.91   146.0           104   5.7  50.7 39.1         117.0\n5  38           8 24.56   103.2            74   4.7 102.5 29.1         145.9\n6  41          10 17.47    67.0            71   4.2 105.3 58.8         140.7\n  WaistCircumference HipCircumference  WHR FamilyHistory DietType Hypertension\n1               90.5            107.9 0.84             0        0            0\n2              113.3             81.4 1.39             0        0            0\n3               84.7            107.2 0.79             0        0            0\n4              108.9            110.0 0.99             0        0            0\n5               84.1             92.8 0.91             0        1            0\n6               81.8             93.2 0.88             1        0            0\n  MedicationUse Outcome\n1             1       0\n2             0       0\n3             1       0\n4             1       1\n5             0       0\n6             0       1\n```\n\n\n:::\n:::\n\n\n\n\nTudo certo! Podemos continuar.\n\n### Leitura do dicionário\n\nO último passo antes de uma boa análise descritiva e exploratória é **ler o dicionário de variáveis**. Isso  é fundamental para entender siglas que podem estar em outra língua, verificar a unidade de medida de cada variável e já identificar sobre qual o tipo de cada coluna.\n\n- Idade (Age): Idade do indivíduo (18-90 anos).\n- Gravidezes (Pregnancies): Número de vezes que a paciente esteve grávida.\n-IMC (Índice de Massa Corporal - BMI): Medida de gordura corporal baseada na altura e peso (kg/m²).\n- Glicose (Glucose): Concentração de glicose no sangue (mg/dL), um indicador-chave de diabetes.\n- Pressão Arterial (BloodPressure): Pressão arterial sistólica (mmHg), níveis elevados podem indicar hipertensão.\n- HbA1c: Nível de hemoglobina glicada (%), representa a média de açúcar no sangue ao longo de meses.\n- LDL (Lipoproteína de Baixa Densidade - Low-Density Lipoprotein): Nível de colesterol \"ruim\" (mg/dL).\n- HDL (Lipoproteína de Alta Densidade - High-Density Lipoprotein): Nível de colesterol \"bom\" (mg/dL).\n- Triglicerídeos (Triglycerides): Níveis de gordura no sangue (mg/dL), valores altos aumentam o risco de diabetes.\n- Circunferência da Cintura (WaistCircumference): Medida da cintura (cm), indicador de obesidade central.\n- Circunferência do Quadril (HipCircumference): Medida do quadril (cm), usada para calcular a relação cintura-quadril.\n- Relação Cintura-Quadril (WHR - Waist-to-Hip Ratio): Circunferência da cintura dividida pela circunferência do quadril.\n- Histórico Familiar (FamilyHistory): Indica se o indivíduo tem histórico familiar de diabetes (1 = Sim, 0 = Não).\n- Tipo de Dieta (DietType): Hábitos alimentares (0 = Desequilibrado, 1 = Equilibrado, 2 = Vegano/Vegetariano).\n- Hipertensão (Hypertension): Presença de pressão alta (1 = Sim, 0 = Não).\n- Uso de Medicamentos (MedicationUse): Indica se o indivíduo faz uso de medicação (1 = Sim, 0 = Não).\n- Resultado (Outcome): Diagnóstico de diabetes (1 = Diabetes, 0 = Sem Diabetes).\n\n### Análise univariada\n\nFinalmente chegamos na etapa de criar gráficos e tabelas. Um importante conhecimento é saber distinguir variáveis contínuas (números e medidas) de variáveis categóricas (classificação de algum tipo, como raça e sexo).\n\nPara variáveis conitínuas, as medidas resumo em uma única tabela são uma excelente forma de adicionar informação em um relatório. Para fins de você, pesquisador, entender seu banco de dados, criar histogramas é uma ótima forma de visualizar o que está acontecendo com cada coluna, perceber outliers e assimetria, mesmo que não os inclua no relatório.  \n\nAssim, para executar o histograma recomendo utilizar o pacote ggplot2, que traz um belo gráfico com relativamente pouco esforço.  \n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndiabetes_dataset %>%  # Abre o banco de dados\n  select(WaistCircumference) %>% # Seleciona a variável de interesse\n  ggplot(aes(x = WaistCircumference)) + # Chama a função de criar gráficos colocando nossa var no eixo x\n  geom_histogram(fill = \"#F2C354\", color = \"white\") + # Cria o histograma com as cores desejadas\n  labs(title = \"Histograma para Circunferência de Cintura em cm\", # Adiciona título \n       x = \"Circunferência de Cintuta (cm)\", # E substitui o texto padrão dos eixos\n       y = \"Frequência\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](data-viz_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\n\n\nE agora para a nossa tabela precisaremos de um pouco mais de código.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Definimos os rótulos em português para cada variável categórica\nrotulos_categoricas <- c(\n  FamilyHistory = \"Histórico Familiar\",  # Indica se o indivíduo tem histórico familiar de diabetes (1 = Sim, 0 = Não)\n  DietType = \"Tipo de Dieta\",  # Hábitos alimentares (0 = Desequilibrado, 1 = Equilibrado, 2 = Vegano/Vegetariano)\n  Hypertension = \"Hipertensão\",  # Presença de pressão alta (1 = Sim, 0 = Não)\n  MedicationUse = \"Uso de Medicamentos\",  # Indica se o indivíduo faz uso de medicação (1 = Sim, 0 = Não)\n  Outcome = \"Resultado\"  # Diagnóstico de diabetes (1 = Diabetes, 0 = Sem Diabetes)\n)\n\n# Selecionamos apenas as variáveis categóricas com base nos rótulos definidos\nvariaveis_categoricas <- names(rotulos_categoricas)\n\n# Calcular a frequência e a proporção para cada categoria das variáveis categóricas\nresumo_categoricas <- diabetes_dataset %>%  # Acessa o dataset\n  select(all_of(variaveis_categoricas)) %>%  # Seleciona as colunas categóricas\n  pivot_longer(cols = everything(), names_to = \"Variável\", values_to = \"Categoria\") %>%  # Converte o formato wide para long\n  group_by(Variável, Categoria) %>%  # Agrupa pelos valores únicos das variáveis categóricas\n  summarise(Frequência = n(), .groups = \"drop\") %>%  # Conta quantas vezes cada categoria aparece\n  mutate(Proporção = Frequência / sum(Frequência) * 100) %>%  # Calcula a porcentagem relativa de cada categoria\n  mutate(Variável = recode(Variável, !!!rotulos_categoricas))  # Substitui os nomes das variáveis pelos rótulos em português\n\n# Criamos a tabela formatada\nresumo_categoricas %>%  # Chama o resumo criado\n  kable(\"html\", \n        caption = \"Distribuição das variáveis categóricas\",  # Utiliza o kable da biblioteca kableExtra\n        align = \"c\",  # Alinha o texto ao centro\n        col.names = c(\"Variável\", \"Categoria\", \"Frequência\", \"Proporção (%)\")) %>%  # Define os nomes das colunas\n  kable_styling(full_width = FALSE, \n                bootstrap_options = c(\"striped\", \"hover\")) %>%  # Aplica configurações de estilo\n  footnote(general = \"Fonte: Elaborado pelo autor.\",  # Adiciona a fonte da tabela\n           general_title = \"\") %>%\n  add_header_above(c(\" \" = 1, \"Estatísticas Descritivas\" = 3))  # Adiciona um cabeçalho para as colunas de estatísticas\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-hover\" style=\"width: auto !important; margin-left: auto; margin-right: auto;border-bottom: 0;\">\n<caption>Distribuição das variáveis categóricas</caption>\n <thead>\n<tr>\n<th style=\"empty-cells: hide;border-bottom:hidden;\" colspan=\"1\"></th>\n<th style=\"border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; \" colspan=\"3\"><div style=\"border-bottom: 1px solid #ddd; padding-bottom: 5px; \">Estatísticas Descritivas</div></th>\n</tr>\n  <tr>\n   <th style=\"text-align:center;\"> Variável </th>\n   <th style=\"text-align:center;\"> Categoria </th>\n   <th style=\"text-align:center;\"> Frequência </th>\n   <th style=\"text-align:center;\"> Proporção (%) </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:center;\"> Tipo de Dieta </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 5794 </td>\n   <td style=\"text-align:center;\"> 12.1492975 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> Tipo de Dieta </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 2851 </td>\n   <td style=\"text-align:center;\"> 5.9781925 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> Tipo de Dieta </td>\n   <td style=\"text-align:center;\"> 2 </td>\n   <td style=\"text-align:center;\"> 893 </td>\n   <td style=\"text-align:center;\"> 1.8725100 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> Histórico Familiar </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 6653 </td>\n   <td style=\"text-align:center;\"> 13.9505137 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> Histórico Familiar </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 2885 </td>\n   <td style=\"text-align:center;\"> 6.0494863 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> Hipertensão </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 9528 </td>\n   <td style=\"text-align:center;\"> 19.9790312 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> Hipertensão </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 10 </td>\n   <td style=\"text-align:center;\"> 0.0209688 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> Uso de Medicamentos </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 5675 </td>\n   <td style=\"text-align:center;\"> 11.8997693 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> Uso de Medicamentos </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 3863 </td>\n   <td style=\"text-align:center;\"> 8.1002307 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> Resultado </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 6256 </td>\n   <td style=\"text-align:center;\"> 13.1180541 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> Resultado </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 3282 </td>\n   <td style=\"text-align:center;\"> 6.8819459 </td>\n  </tr>\n</tbody>\n<tfoot><tr><td style=\"padding: 0; \" colspan=\"100%\">\n<sup></sup> Fonte: Elaborado pelo autor.</td></tr></tfoot>\n</table>\n\n`````\n:::\n:::\n\n\n\n\nPara outras formatações basta pesquisar um pouco na documentação do pacote kableExtra e entender o que precisa ser alterado.\n\n\nPara variáveis categóricas, o processo é bem similar. Iremos criar um gráfico de barras (nunca de pizza!!) e uma tabela com as medidas resumo.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndiabetes_dataset %>%  # Abre o banco de dados\n  select(FamilyHistory) %>% # Seleciona a variável de interesse\n  ggplot(aes(x = as.factor(FamilyHistory))) + # Chama a função de criar gráficos colocando nossa var no eixo x como fator (ou seja var categorica)\n  geom_bar(fill = \"#C97064\", color = \"white\") + # Cria o ghráfico de barras com as cores desejadas\n  labs(title = \"Distribuição para Histórico Familiar de Daibetes\", # Adiciona título \n       x = \"Possui histórico familiar? (0 = não, 1 = sim)\", # E substitui o texto padrão dos eixos\n       y = \"Frequência\")\n```\n\n::: {.cell-output-display}\n![](data-viz_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\n\n\nPode ser interessante também criar um gráfico para as proporções do grupo no eixo y, a fim de facilitar a vizualização. Basta alterar algumas linhas de código como se vê abaixo.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndiabetes_dataset %>%  # Abre o banco de dados\n  count(FamilyHistory) %>% # Conta as ocorrências de cada categoria\n  mutate(Proporção = n / sum(n)) %>% # Calcula a proporção\n  ggplot(aes(x = as.factor(FamilyHistory), y = Proporção)) + # Define os eixos\n  geom_col(fill = \"#68A357\", color = \"white\") + # Cria o gráfico de barras\n  labs(title = \"Distribuição do Histórico Familiar de Diabetes\", # Adiciona título\n       x = \"Possui histórico familiar? (0 = não, 1 = sim)\", # E substitui o texto padrão dos eixos\n       y = \"Proporção\") \n```\n\n::: {.cell-output-display}\n![](data-viz_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\n\nPor fim, agora vamos fazer as tabelas para as variáveis categóricas.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Definimos os rótulos em português para cada variável categórica\nrotulos_categoricas <- c(\n  FamilyHistory = \"Histórico Familiar\",  # Indica se o indivíduo tem histórico familiar de diabetes (1 = Sim, 0 = Não)\n  DietType = \"Tipo de Dieta\",  # Hábitos alimentares (0 = Desequilibrado, 1 = Equilibrado, 2 = Vegano/Vegetariano)\n  Hypertension = \"Hipertensão\",  # Presença de pressão alta (1 = Sim, 0 = Não)\n  MedicationUse = \"Uso de Medicamentos\",  # Indica se o indivíduo faz uso de medicação (1 = Sim, 0 = Não)\n  Outcome = \"Resultado\"  # Diagnóstico de diabetes (1 = Diabetes, 0 = Sem Diabetes)\n)\n\n# Selecionamos apenas as variáveis categóricas com base nos rótulos definidos\nvariaveis_categoricas <- names(rotulos_categoricas)\n\n# Calcular a frequência e a proporção para cada categoria das variáveis categóricas\nresumo_categoricas <- diabetes_dataset %>%  # Acessa o dataset\n  select(all_of(variaveis_categoricas)) %>%  # Seleciona as colunas categóricas\n  pivot_longer(cols = everything(), names_to = \"Variável\", values_to = \"Categoria\") %>%  # Converte o formato wide para long\n  group_by(Variável, Categoria) %>%  # Agrupa pelos valores únicos das variáveis categóricas\n  summarise(Frequência = n(), .groups = \"drop\") %>%  # Conta quantas vezes cada categoria aparece\n  mutate(Proporção = Frequência / sum(Frequência) * 100) %>%  # Calcula a porcentagem relativa de cada categoria\n  mutate(Variável = recode(Variável, !!!rotulos_categoricas))  # Substitui os nomes das variáveis pelos rótulos em português\n\n# Ajustamos para remover a repetição do nome da variável\nresumo_categoricas <- resumo_categoricas %>%\n  group_by(Variável) %>%\n  mutate(Variável = ifelse(row_number() == 1, Variável, \"\")) %>%  # Mantém o nome apenas na primeira linha de cada grupo\n  ungroup()\n\n# Criamos a tabela formatada\nresumo_categoricas %>%  # Chama o resumo criado\n  kable(\"html\", \n        caption = \"Distribuição das variáveis categóricas\",  # Utiliza o kable da biblioteca kableExtra\n        align = \"c\",  # Alinha o texto ao centro\n        col.names = c(\"Variável\", \"Categoria\", \"Frequência\", \"Proporção (%)\")) %>%  # Define os nomes das colunas\n  kable_styling(full_width = FALSE, \n                bootstrap_options = c(\"striped\", \"hover\")) %>%  # Aplica configurações de estilo\n  footnote(general = \"Fonte: Elaborado pelo autor.\",  # Adiciona a fonte da tabela\n           general_title = \"\") %>%\n  add_header_above(c(\" \" = 1, \"Estatísticas Descritivas\" = 3))  # Adiciona um cabeçalho para as colunas de estatísticas\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-hover\" style=\"width: auto !important; margin-left: auto; margin-right: auto;border-bottom: 0;\">\n<caption>Distribuição das variáveis categóricas</caption>\n <thead>\n<tr>\n<th style=\"empty-cells: hide;border-bottom:hidden;\" colspan=\"1\"></th>\n<th style=\"border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; \" colspan=\"3\"><div style=\"border-bottom: 1px solid #ddd; padding-bottom: 5px; \">Estatísticas Descritivas</div></th>\n</tr>\n  <tr>\n   <th style=\"text-align:center;\"> Variável </th>\n   <th style=\"text-align:center;\"> Categoria </th>\n   <th style=\"text-align:center;\"> Frequência </th>\n   <th style=\"text-align:center;\"> Proporção (%) </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:center;\"> Tipo de Dieta </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 5794 </td>\n   <td style=\"text-align:center;\"> 12.1492975 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\">  </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 2851 </td>\n   <td style=\"text-align:center;\"> 5.9781925 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\">  </td>\n   <td style=\"text-align:center;\"> 2 </td>\n   <td style=\"text-align:center;\"> 893 </td>\n   <td style=\"text-align:center;\"> 1.8725100 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> Histórico Familiar </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 6653 </td>\n   <td style=\"text-align:center;\"> 13.9505137 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\">  </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 2885 </td>\n   <td style=\"text-align:center;\"> 6.0494863 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> Hipertensão </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 9528 </td>\n   <td style=\"text-align:center;\"> 19.9790312 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\">  </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 10 </td>\n   <td style=\"text-align:center;\"> 0.0209688 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> Uso de Medicamentos </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 5675 </td>\n   <td style=\"text-align:center;\"> 11.8997693 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\">  </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 3863 </td>\n   <td style=\"text-align:center;\"> 8.1002307 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> Resultado </td>\n   <td style=\"text-align:center;\"> 0 </td>\n   <td style=\"text-align:center;\"> 6256 </td>\n   <td style=\"text-align:center;\"> 13.1180541 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\">  </td>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> 3282 </td>\n   <td style=\"text-align:center;\"> 6.8819459 </td>\n  </tr>\n</tbody>\n<tfoot><tr><td style=\"padding: 0; \" colspan=\"100%\">\n<sup></sup> Fonte: Elaborado pelo autor.</td></tr></tfoot>\n</table>\n\n`````\n:::\n:::\n\n\n\n\n### Análise bivariada\n\nA análise univariada tem como objetivo entender a distribuição da variável em si. Já na análise bivariada (e multivariada), queremos entender qual a relação das variáveis entre si. Note que não estou buscando a causalidade nem no valor preditivo de cada variável, isso será uma etapa posterior a depender do seu objetivo de pesquisa.\n\nPodemos começar com um correlograma, que traz um mapa das correlações de todas as variáveis contínuas entre si. É muito útil para identificar se há alguma colinearidade entre variáveis, que deve ser confirmada depois através dos testes apropriados.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Selecionamos apenas as variáveis contínuas\nvariaveis_continuas <- c(\"Age\", \"BMI\", \"Glucose\", \"BloodPressure\", \"HbA1c\",\n                         \"LDL\", \"HDL\", \"Triglycerides\", \"WaistCircumference\",\n                         \"HipCircumference\", \"WHR\")\n\n# Criamos a matriz de correlação\nmatriz_correlacao <- diabetes_dataset %>% \n  select(all_of(variaveis_continuas)) %>%  # Seleciona apenas as variáveis contínuas\n  cor(use = \"pairwise.complete.obs\")  # Calcula a correlação excluindo valores NA\n\n# Criamos o correlograma\nggcorrplot(matriz_correlacao, \n           method = \"circle\",  # Define o estilo do gráfico (círculos)\n           type = \"lower\",  # Mostra apenas a metade inferior da matriz\n           lab = TRUE,  # Exibe os valores das correlações\n           lab_size = 3,  # Tamanho da fonte dos rótulos\n           colors = c(\"#6D9EC1\", \"white\", \"#E46726\"),  # Define a paleta de cores\n           title = \"Correlograma das Variáveis Contínuas\",  # Adiciona um título\n           ggtheme = theme_minimal())  # Aplica um tema minimalista\n```\n\n::: {.cell-output-display}\n![](data-viz_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n\n\n\nOutra forma de correlação muito importante, principalmente para estudos de predição, é a correlação de cada variável com o desfecho.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Definimos variáveis contínuas e categóricas\nvariaveis_continuas <- c(\"Age\", \"BMI\", \"Glucose\", \"BloodPressure\", \"HbA1c\",\n                         \"LDL\", \"HDL\", \"Triglycerides\", \"WaistCircumference\",\n                         \"HipCircumference\", \"WHR\")\n\nvariaveis_categoricas <- c(\"FamilyHistory\", \"DietType\", \"Hypertension\", \n                           \"MedicationUse\")\n\n# --- Correlação para variáveis contínuas com Outcome ---\ncorrelacoes_continuas <- diabetes_dataset %>% \n  select(all_of(variaveis_continuas), Outcome) %>% \n  cor(use = \"pairwise.complete.obs\") %>% \n  as.data.frame() %>%\n  select(Outcome) %>%\n  rownames_to_column(var = \"Variável\") %>%\n  rename(`Correlação` = Outcome) %>%  # Renomeia para manter consistência\n  mutate(Tipo = \"Contínua\")\n\n# --- Correlação para variáveis categóricas com Outcome ---\ncalcular_cramer <- function(var) {\n  tab <- table(diabetes_dataset[[var]], diabetes_dataset$Outcome)\n  cramer <- rstatix::cramer_v(tab) %>% as.numeric()  # Converte para número\n  return(data.frame(Variável = var, `Correlação` = cramer, Tipo = \"Categórica\"))\n}\n\ncorrelacoes_categoricas <- bind_rows(lapply(variaveis_categoricas, calcular_cramer))\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning in stats::chisq.test(x, y, correct = correct, ...): Aproximação do\nqui-quadrado pode estar incorreta\n```\n\n\n:::\n\n```{.r .cell-code}\n# --- Juntamos todas as correlações ---\ncorrelacoes_totais <- bind_rows(correlacoes_continuas, correlacoes_categoricas) %>%\n  arrange(desc(abs(Correlação)))  # Ordena pela força da correlação\n\n# Defininmos os rótulos em português para todas as variáveis\nrotulos <- c(\n  Age = \"Idade (anos)\",\n  BMI = \"Índice de Massa Corporal (kg/m²)\",\n  Glucose = \"Glicose (mg/dL)\",\n  BloodPressure = \"Pressão Arterial (mmHg)\",\n  HbA1c = \"Hemoglobina Glicada (%)\",\n  LDL = \"Colesterol LDL (mg/dL)\",\n  HDL = \"Colesterol HDL (mg/dL)\",\n  Triglycerides = \"Triglicerídeos (mg/dL)\",\n  WaistCircumference = \"Circunferência da Cintura (cm)\",\n  HipCircumference = \"Circunferência do Quadril (cm)\",\n  WHR = \"Relação Cintura-Quadril\",\n  FamilyHistory = \"Histórico Familiar\",\n  DietType = \"Tipo de Dieta\",\n  Hypertension = \"Hipertensão\",\n  MedicationUse = \"Uso de Medicamentos\"\n)\n\n# Removemos a correlação de Outcome consigo mesmo\ncorrelacoes_totais <- correlacoes_totais %>% \n  filter(Variável != \"Outcome\") %>% \n  mutate(Variável = recode(Variável, !!!rotulos))  # Aplicar rótulos\n\n# Exibimos a tabela formatada\ncorrelacoes_totais %>%\n  mutate(Correlação = round(Correlação, 3)) %>%  # Arredonda valores\n  kable(\"html\", \n        caption = \"Correlação de Todas as Variáveis com o Desfecho\", \n        align = \"c\", \n        col.names = c(\"Variável\", \"Correlação\", \"Tipo\")) %>%  # Define nomes das colunas\n  kable_styling(full_width = FALSE, \n                bootstrap_options = c(\"striped\", \"hover\")) %>%  # Estilização\n  footnote(general = \"Fonte: Elaborado pelo autor.\", \n           general_title = \"\") %>%\n  add_header_above(c(\" \" = 1, \"Correlação com o Desfecho\" = 2))  # Cabeçalho superior\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-hover\" style=\"width: auto !important; margin-left: auto; margin-right: auto;border-bottom: 0;\">\n<caption>Correlação de Todas as Variáveis com o Desfecho</caption>\n <thead>\n<tr>\n<th style=\"empty-cells: hide;border-bottom:hidden;\" colspan=\"1\"></th>\n<th style=\"border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; \" colspan=\"2\"><div style=\"border-bottom: 1px solid #ddd; padding-bottom: 5px; \">Correlação com o Desfecho</div></th>\n</tr>\n  <tr>\n   <th style=\"text-align:center;\"> Variável </th>\n   <th style=\"text-align:center;\"> Correlação </th>\n   <th style=\"text-align:center;\"> Tipo </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:center;\"> Histórico Familiar </td>\n   <td style=\"text-align:center;\"> 0.909 </td>\n   <td style=\"text-align:center;\"> Categórica </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> Glicose (mg/dL) </td>\n   <td style=\"text-align:center;\"> 0.168 </td>\n   <td style=\"text-align:center;\"> Contínua </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> Hemoglobina Glicada (%) </td>\n   <td style=\"text-align:center;\"> 0.152 </td>\n   <td style=\"text-align:center;\"> Contínua </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> Índice de Massa Corporal (kg/m²) </td>\n   <td style=\"text-align:center;\"> 0.107 </td>\n   <td style=\"text-align:center;\"> Contínua </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> Pressão Arterial (mmHg) </td>\n   <td style=\"text-align:center;\"> 0.096 </td>\n   <td style=\"text-align:center;\"> Contínua </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> Circunferência da Cintura (cm) </td>\n   <td style=\"text-align:center;\"> 0.087 </td>\n   <td style=\"text-align:center;\"> Contínua </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> Circunferência do Quadril (cm) </td>\n   <td style=\"text-align:center;\"> 0.083 </td>\n   <td style=\"text-align:center;\"> Contínua </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> Idade (anos) </td>\n   <td style=\"text-align:center;\"> 0.068 </td>\n   <td style=\"text-align:center;\"> Contínua </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> Uso de Medicamentos </td>\n   <td style=\"text-align:center;\"> 0.064 </td>\n   <td style=\"text-align:center;\"> Categórica </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> Hipertensão </td>\n   <td style=\"text-align:center;\"> 0.028 </td>\n   <td style=\"text-align:center;\"> Categórica </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> Relação Cintura-Quadril </td>\n   <td style=\"text-align:center;\"> 0.022 </td>\n   <td style=\"text-align:center;\"> Contínua </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> Colesterol LDL (mg/dL) </td>\n   <td style=\"text-align:center;\"> 0.019 </td>\n   <td style=\"text-align:center;\"> Contínua </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> Tipo de Dieta </td>\n   <td style=\"text-align:center;\"> 0.016 </td>\n   <td style=\"text-align:center;\"> Categórica </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> Colesterol HDL (mg/dL) </td>\n   <td style=\"text-align:center;\"> -0.009 </td>\n   <td style=\"text-align:center;\"> Contínua </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> Triglicerídeos (mg/dL) </td>\n   <td style=\"text-align:center;\"> -0.008 </td>\n   <td style=\"text-align:center;\"> Contínua </td>\n  </tr>\n</tbody>\n<tfoot><tr><td style=\"padding: 0; \" colspan=\"100%\">\n<sup></sup> Fonte: Elaborado pelo autor.</td></tr></tfoot>\n</table>\n\n`````\n:::\n:::\n\n\n\n\nA partir das correlações dadas podemos criar gráficos bivariados com a variável de interesse e uma covariável.\n\nPara covariável contínua, utilizaremos o boxplot como visualização e para variáveis categóricas gráficos de barras empilhadas.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndiabetes_dataset %>% # Abre o banco de dados\n  ggplot(aes(x = as.factor(FamilyHistory), fill = as.factor(Outcome))) + # Chama a função de gráficos preenchendo com o desfecho\n  geom_bar(position = \"fill\", color = \"white\") +  # Proporção dentro de cada grupo\n  scale_fill_manual(values = c(\"#C97064\", \"#68A357\"), labels = c(\"Sem Diabetes\", \"Diabetes\")) + # Escolhe as cores\n  labs(title = \"Distribuição do Histórico Familiar por Desfecho\", # Adiciona título\n       x = \"Histórico Familiar (0 = Não, 1 = Sim)\",  # Adiciona legendas\n       y = \"Proporção\",\n       fill = \"Desfecho\")\n```\n\n::: {.cell-output-display}\n![](data-viz_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndiabetes_dataset %>% # Abre o banco de dados\n  ggplot(aes(x = as.factor(Outcome), y = Glucose, fill = as.factor(Outcome))) + # Chama a função de gráficos com preenchimento com o desfecho\n  geom_boxplot(outlier.color = \"red\", outlier.shape = 16) + # Cria o boxplot\n  scale_fill_manual(values = c(\"#C97064\", \"#68A357\"), labels = c(\"Sem Diabetes\", \"Diabetes\")) + # Escolhe as cores\n  labs(title = \"Distribuição da Glicose por Desfecho\", # Adiciona título\n       x = \"Desfecho\", # Adiciona legendas\n       y = \"Glicose (mg/dL)\",\n       fill = \"Desfecho\")\n```\n\n::: {.cell-output-display}\n![](data-viz_files/figure-html/unnamed-chunk-13-1.png){width=672}\n:::\n:::\n\n\n\n\n\n### Considerações finais\n\nO passo a passo sugerido aqui é tanto para criação de relatórios iniciais tanto quanto para o próprio pesquisador entender melhor a base de dados trabalhada. É fundamental fazer cada etapa com cuidado e perceber a necessidade de pré-processamento das variáveis, como ajuste de character para factor, e adaptar os scripts conforme a necessidade. \n\nEspero ter ajudado!\n",
    "supporting": [
      "data-viz_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../../site_libs/kePrint-0.0.1/kePrint.js\"></script>\n<link href=\"../../site_libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}